<engine>
    <template selector=".content">
        <div class="innercontent">
            <h2>${spritefoundry.user.name}'s Sprites</h2>
            <table class="spriteTable">
                <tr>
                    <th>Name</th>
                    <th>Last Modified</th>
                    <th>Edit</th>
                    <th>Delete</th>
                </tr>
                {for s in param}
                <tr>
                    <td class="id">${s._self}</td>
                    <td>${s.name}</td>
                    <td>${new Date(s._lastModified)}</td>
                    <td><a href="#sprite/${s._self.getLastNode()}"><img src="/imgs/edit.png"/></a></td>
                    <td><a href="#" class="delete"><img src="/imgs/trash.png"/></a></td>
                </tr>
                {/for}
            </table>
            <div class="deletedinfo allborder">
                <img src="/imgs/deleted.png" />
                Deleted!
            </div>
        </div>
    </template>
    <script>
        <![CDATA[
            $("table.spriteTable").datatable();
            $("table.spriteTable tr td a.delete").click(function() {
                var td = $(this);
                foundry.confirmDialog( {
                    message : "Do you really want to delete this sprite sheet? This action can't be undone!",
                    onconfirm: function() {
                        var tr = td.closest("tr");
                        var id = tr.find(".id").text();
                        $.ajax({
                            url: id,
                            type: "DELETE",
                            success: function() {
                                tr.fadeOut("fast", function() {
                                    $(this).remove();
                                    $("div.deletedinfo").fadeIn("fast", function() {
                                        setTimeout(function() {
                                            $("div.deletedinfo").fadeOut();
                                        },1500);
                                    });
                                });
                            }
                        });
                    }
                });
                return false;
            });
        ]]>
    </script>
</engine>